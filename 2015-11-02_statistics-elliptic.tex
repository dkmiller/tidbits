\documentclass{article}

\usepackage{amsmath,amssymb,amsthm,microtype}
\usepackage[a5paper,margin=1.5cm]{geometry}
\DeclareMathOperator{\GL}{GL}
\DeclareMathOperator{\h}{H}
\DeclareMathOperator{\PGL}{PGL}
\DeclareMathOperator{\sign}{sgn}
\DeclareMathOperator{\trace}{tr}
\newcommand{\bC}{\mathbf{C}}
\newcommand{\bF}{\mathbf{F}}
\newcommand{\bQ}{\mathbf{Q}}
\newcommand{\bR}{\mathbf{R}}
\newcommand{\bZ}{\mathbf{Z}}
\newcommand{\dd}{\mathrm{d}}
\newcommand{\frob}{\mathrm{fr}}
\newtheorem{theorem}{Theorem}
\numberwithin{theorem}{section}

\title{The statistics of the signed trace of Frobenius for elliptic curves}
\author{Daniel Miller}

\begin{document}
\maketitle





\section{Introduction}

Let $E_{/\bQ}$ be an elliptic curve of conductor $N$, $l$ a rational prime and 
$\rho=\rho_{E,l}\colon G_\bQ\to \GL_2(\bZ_l)$ the associated Galois 
representation coming from the Tate module of $E$. We have the sequence 
$\{a_p(E)\}_{p\nmid N l}$, defined by 
\[
	a_p(E) = \trace \rho(\frob_p) .
\]
It is well-known that $a_p(E)\in \bZ$, are independent of $l$, and satisfy 
the \emph{Hasse bound}:
\[
	|a_p(E)| \leqslant 2\sqrt p .
\]
Moreover, Faltings proved that the sequence $a(E) = \{a_p(E)\}$ determines the 
isogeny class of $E$. 

We can define a new sequence, $s(E) = \{s_p=s_p(E)\}_{p\nmid N}$, by 
$s_p = \sign(a_p)$. Write $s_{\leqslant X}(E)$ for 
$\{s_p(E)\colon p\leqslant X\}$. It is known that $s(E)$ determines $E$, but 
the proof depends on very deep results coming from Michael Harris 
and his school. Our goal is to show that, with some elementary input from 
representation theory, the fact that $s(E)$ determines $E$ follows from the 
fact that $a(E)$ determines $E$. 





\section{Motivation from characteristic zero}

Let $\Gamma$ be a finite group, $\rho\colon \Gamma\to \GL(V)$ a 
finite-dimensional absolutely irreducible real representation. Put 
$\chi_\rho=\trace\rho$ and $\sigma_\rho = \sign(\chi_\rho)$. We conjecture that 
$\sigma_\rho$, not just $\chi_\rho$,  determines $\rho$ up to isomorphism. For 
symmetric groups $S_n$, all irreducible representations are real, and the 
conjecture has been checked by the author for $S_n$ up to $n=17$, $D_n$ up 
to $n=20$, $A_n$ up to $n=11$, and $\PGL(2,\bF_p)$ up to $p=31$. Finally, this 
can be proved directly. 

\begin{theorem}
Let $G$ be a compact group, $\rho_1,\rho_2$ two finite-dimensional, 
continuous, irreducbile complex representations with real traces. If 
$\sign(\trace \rho_1) = \sign(\trace \rho_2)$, then $\rho_1\simeq \rho_2$. 
\end{theorem}
\begin{proof}
Representations of a compact group are self-dual, so 
$\hom_\bC(\rho_1,\rho_2) = \rho_1\otimes \rho_2$. For there to be an 
isomorphism between $\rho_1$ and $\rho_2$, we need 
$\h^0(\rho_1\otimes \rho_2) \ne 0$. That is, we need 
\[
	\langle 1, \trace(\rho_1\otimes \rho_2)\rangle = \int_G \trace \rho_1(g) \trace \rho_2(g)\, \dd g
\]
to be nonzero. Since $\sign(\trace \rho_1) = \sign(\trace \rho_2)$, the 
integrand is nonnegative. Moreover, since 
$\rho_1(1) \rho_2(1) = 1$, continuity gives us an open neighborhood 
$U$ of $1$ for which $\rho_1,\rho_2\geqslant 1/2$. We conclude that 
$\langle 1, \trace(\rho_1\otimes \rho_2)\rangle>0$, and the result follows. 
\end{proof}





\section{The main idea}

Let $E_{/\bQ}$ be an elliptic curve of conductor $N$. Since 
$|a_p|\leqslant 2\sqrt p$, if $l>4\sqrt p$, then $a_p$ is determined by its 
reduction modulo $l$. In fact, it is given by the function $\overline\sign$, 
defined by 
\[
	\overline\sign(x) = 
	\begin{cases}
		0 & x=0 \\
		1 & x\equiv 1,\dots,\frac{l-1}{2}\pmod l \\
		-1 & x\equiv \frac{l+1}{2},\dots,l-1\pmod l .
	\end{cases}
\]
If $l$ is not clear from the context, we write $\overline\sign_l$. 

\textbf{Conjecture.} Let $\Gamma$ be a finite group, 
$\rho_1,\rho_2\colon \Gamma\twoheadrightarrow \GL_2(\bF_l)$ two 
representations. If $\det\rho_1=\det\rho_2$ and 
$\overline\sign\trace\rho_1 = \overline\sign\trace\rho_2$, then 
$\rho_1\simeq \rho_2$. 

\textbf{Theorem.} If the conjecture is true, then $E$ is determined by the 
first $O(N\log\log N)$ of the $s_p(E)$. 

\begin{proof}
Let $E_{/\bQ}$ be an elliptic curve with conductor $N$. It is known that the 
first $O(N\log\log N)$ of the $a_p$ determine $E$. Choose a prime $l$ larger 
than $4\sqrt p$ for $p$ the largest of the $O(N\log \log N)$ primes. Then 
we can recover $a_p$ for all $p<\frac{1}{16} l^2$ from $a_p\mod l$. In other 
words, $\bar\rho=\rho\mod l$ determines $E$. If $E_1$ and $E_2$ both have 
conductor $\leqslant N$ and their first $O(N\log\log N)$ of the $s_p$ are 
equal, then 
$\overline\sign\trace \bar\rho_{E_1,l} = \overline\sign\trace \bar\rho_{E_2,l}$. 
By the conjecture, $\bar\rho_{E_1,l}\simeq \bar\rho_{E_2,l}$, hence 
$a_p(E_1)\equiv a_p(E_2)\mod l$ for $p<\frac{1}{16} l^2$. Together with the 
Hasse bound, this implies $a_p(E_1) = a_p(E_2)$ for those $p$, hence 
$E_1$ and $E_2$ are isogenous. 
\end{proof}





\end{document}

$schema: https://azuremlschemas.azureedge.net/development/CommandComponent.schema.json
type: command

name: finetune_huggingface
display_name: Finetune Huggingface
version: 0.0.0

description: |
  TODO

inputs:
  train_data:
    type: path
  train_file:
    type: string

outputs:
  checkpoint:
    type: path

code: .

command: >-
  python train.py
  --input-dir ${{inputs.train_data}}
  --input-file ${{inputs.train_file}}
  --output_dir ${{outputs.checkpoint}}
  --learning_rate 2e-5
  --per_device_train_batch_size 16
  --num_train_epochs 5
  --weight_decay 0.01

environment:
  conda_file: conda.yaml
  image: mcr.microsoft.com/azureml/openmpi4.1.0-cuda11.1-cudnn8-ubuntu20.04
